export async function computePackageJson({ packageInfo, dependencies, sharedConfig = {}, }) {
    const shared = { ...sharedConfig };
    const keys = Object.keys(shared);
    keys.forEach((key) => {
        const value = shared[key];
        if (typeof value === 'string') {
            //@ts-ignore
            shared[key] = value
                .replace(/({name})/g, packageInfo.name) // {name}
                .replace(/({version})/g, packageInfo.version); // {version}
        }
    });
    const computedConfig = {
        ...shared,
        //main: 'index.js',
        typings: 'index.d.ts',
        ...packageInfo.packageJson,
        name: packageInfo.name,
        version: packageInfo.version,
        dependencies: dependencies,
    };
    const commonjsDirectory = packageInfo.exports.main === 'commonjs' ? '.' : './_commonjs';
    computedConfig.main = `${commonjsDirectory}/index.js`;
    if (packageInfo.exports.module) {
        const moduleDirectory = packageInfo.exports.main === 'module' ? '.' : './_module';
        computedConfig.module = `${moduleDirectory}/index.js`;
    }
    return computedConfig;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcHV0ZVBhY2thZ2VKc29uLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL3JvY2tldC1wdW5jaC9wYWNrYWdlLWpzb24vY29tcHV0ZVBhY2thZ2VKc29uLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQVNBLE1BQU0sQ0FBQyxLQUFLLFVBQVUsa0JBQWtCLENBQUMsRUFDdkMsV0FBVyxFQUNYLFlBQVksRUFDWixZQUFZLEdBQUcsRUFBRSxHQUNWO0lBQ1AsTUFBTSxNQUFNLEdBQWdCLEVBQUUsR0FBRyxZQUFZLEVBQUUsQ0FBQztJQUNoRCxNQUFNLElBQUksR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBMEIsQ0FBQztJQUUxRCxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsR0FBRyxFQUFFLEVBQUU7UUFDbkIsTUFBTSxLQUFLLEdBQVksTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ25DLElBQUksT0FBTyxLQUFLLEtBQUssUUFBUSxFQUFFO1lBQzdCLFlBQVk7WUFDWixNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsS0FBSztpQkFDaEIsT0FBTyxDQUFDLFdBQVcsRUFBRSxXQUFXLENBQUMsSUFBSSxDQUFDLENBQUMsU0FBUztpQkFDaEQsT0FBTyxDQUFDLGNBQWMsRUFBRSxXQUFXLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxZQUFZO1NBQzlEO0lBQ0gsQ0FBQyxDQUFDLENBQUM7SUFFSCxNQUFNLGNBQWMsR0FBZ0I7UUFDbEMsR0FBRyxNQUFNO1FBRVQsbUJBQW1CO1FBQ25CLE9BQU8sRUFBRSxZQUFZO1FBRXJCLEdBQUcsV0FBVyxDQUFDLFdBQVc7UUFFMUIsSUFBSSxFQUFFLFdBQVcsQ0FBQyxJQUFJO1FBQ3RCLE9BQU8sRUFBRSxXQUFXLENBQUMsT0FBTztRQUM1QixZQUFZLEVBQUUsWUFBWTtLQUMzQixDQUFDO0lBRUYsTUFBTSxpQkFBaUIsR0FDckIsV0FBVyxDQUFDLE9BQU8sQ0FBQyxJQUFJLEtBQUssVUFBVSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQztJQUNoRSxjQUFjLENBQUMsSUFBSSxHQUFHLEdBQUcsaUJBQWlCLFdBQVcsQ0FBQztJQUV0RCxJQUFJLFdBQVcsQ0FBQyxPQUFPLENBQUMsTUFBTSxFQUFFO1FBQzlCLE1BQU0sZUFBZSxHQUNuQixXQUFXLENBQUMsT0FBTyxDQUFDLElBQUksS0FBSyxRQUFRLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDO1FBQzVELGNBQWMsQ0FBQyxNQUFNLEdBQUcsR0FBRyxlQUFlLFdBQVcsQ0FBQztLQUN2RDtJQUVELE9BQU8sY0FBYyxDQUFDO0FBQ3hCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWNrYWdlSnNvbiB9IGZyb20gJ3R5cGUtZmVzdCc7XG5pbXBvcnQgeyBQYWNrYWdlSW5mbyB9IGZyb20gJy4uL3R5cGVzJztcblxuaW50ZXJmYWNlIFBhcmFtcyB7XG4gIHBhY2thZ2VJbmZvOiBQYWNrYWdlSW5mbztcbiAgZGVwZW5kZW5jaWVzOiBQYWNrYWdlSnNvbi5EZXBlbmRlbmN5O1xuICBzaGFyZWRDb25maWc/OiBQYWNrYWdlSnNvbjtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNvbXB1dGVQYWNrYWdlSnNvbih7XG4gIHBhY2thZ2VJbmZvLFxuICBkZXBlbmRlbmNpZXMsXG4gIHNoYXJlZENvbmZpZyA9IHt9LFxufTogUGFyYW1zKTogUHJvbWlzZTxQYWNrYWdlSnNvbj4ge1xuICBjb25zdCBzaGFyZWQ6IFBhY2thZ2VKc29uID0geyAuLi5zaGFyZWRDb25maWcgfTtcbiAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKHNoYXJlZCkgYXMgKGtleW9mIFBhY2thZ2VKc29uKVtdO1xuXG4gIGtleXMuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgY29uc3QgdmFsdWU6IHVua25vd24gPSBzaGFyZWRba2V5XTtcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgLy9AdHMtaWdub3JlXG4gICAgICBzaGFyZWRba2V5XSA9IHZhbHVlXG4gICAgICAgIC5yZXBsYWNlKC8oe25hbWV9KS9nLCBwYWNrYWdlSW5mby5uYW1lKSAvLyB7bmFtZX1cbiAgICAgICAgLnJlcGxhY2UoLyh7dmVyc2lvbn0pL2csIHBhY2thZ2VJbmZvLnZlcnNpb24pOyAvLyB7dmVyc2lvbn1cbiAgICB9XG4gIH0pO1xuXG4gIGNvbnN0IGNvbXB1dGVkQ29uZmlnOiBQYWNrYWdlSnNvbiA9IHtcbiAgICAuLi5zaGFyZWQsXG5cbiAgICAvL21haW46ICdpbmRleC5qcycsXG4gICAgdHlwaW5nczogJ2luZGV4LmQudHMnLFxuXG4gICAgLi4ucGFja2FnZUluZm8ucGFja2FnZUpzb24sXG5cbiAgICBuYW1lOiBwYWNrYWdlSW5mby5uYW1lLFxuICAgIHZlcnNpb246IHBhY2thZ2VJbmZvLnZlcnNpb24sXG4gICAgZGVwZW5kZW5jaWVzOiBkZXBlbmRlbmNpZXMsXG4gIH07XG5cbiAgY29uc3QgY29tbW9uanNEaXJlY3RvcnkgPVxuICAgIHBhY2thZ2VJbmZvLmV4cG9ydHMubWFpbiA9PT0gJ2NvbW1vbmpzJyA/ICcuJyA6ICcuL19jb21tb25qcyc7XG4gIGNvbXB1dGVkQ29uZmlnLm1haW4gPSBgJHtjb21tb25qc0RpcmVjdG9yeX0vaW5kZXguanNgO1xuXG4gIGlmIChwYWNrYWdlSW5mby5leHBvcnRzLm1vZHVsZSkge1xuICAgIGNvbnN0IG1vZHVsZURpcmVjdG9yeSA9XG4gICAgICBwYWNrYWdlSW5mby5leHBvcnRzLm1haW4gPT09ICdtb2R1bGUnID8gJy4nIDogJy4vX21vZHVsZSc7XG4gICAgY29tcHV0ZWRDb25maWcubW9kdWxlID0gYCR7bW9kdWxlRGlyZWN0b3J5fS9pbmRleC5qc2A7XG4gIH1cblxuICByZXR1cm4gY29tcHV0ZWRDb25maWc7XG59XG4iXX0=